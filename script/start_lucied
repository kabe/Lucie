ENV[ 'RAILS_ENV' ] = 'lucied'

require File.dirname(__FILE__) + '/../config/boot'
require RAILS_ROOT + '/config/environment'

require 'etc'


unless Etc.getpwuid( Process.uid ).name == 'root'
  STDERR.puts "ERROR: You must be root."
  exit -1
end


begin
  LuciedBlocker.block
  system( "#{ RAILS_ROOT }/script/lucied" )
rescue => e
  STDERR.puts "FAILED: #{ e.message }"
  exit -1
end


puts "Lucie daemon (lucied) started on port #{ LucieDaemon::PORT }."


### Local variables:
### mode: Ruby
### coding: utf-8
### indent-tabs-mode: nil
### End:
